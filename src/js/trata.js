var counter=0,titulo=[],toggleCheck=document.getElementById("restrict_access"),toggleUI=document.getElementById("conditional");toggleCheck.addEventListener("change",function(){toggleCheck.checked?toggleUI.classList.remove("hidden"):toggleUI.classList.add("hidden")},!1);var elements=document.getElementsByClassName("delete");function clickToRemoveHandler(){var e=this.parentNode;e.classList.add("fadeout"),setTimeout(function(){e.classList.add("slideup"),setTimeout(function(){e.parentNode.removeChild(e)},150),counter-=1},150),null==e.length&&$(":submit").attr("disabled","disabled");var t=titulo.length;titulo.pop(),2==t&&($("label[for=tdiag11]").html("Diagnóstico"),$("#diag2").attr("hidden","true"),$("textarea#tdiag21").removeAttr("required"),$(".equis0").removeClass("escondido"),$(":submit").removeAttr("disabled")),3==t&&($("#diag3").attr("hidden","true"),$("#conditional").removeAttr("hidden"),$("textarea#tdiag31").removeAttr("required"),$(".equis1").removeClass("escondido"),$(".avisog").removeClass("parriba"),$(":submit").removeAttr("disabled"))}function itemAddHandler(e){e.classList.add("slidedown"),setTimeout(function(){e.classList.remove("hidden"),e.classList.remove("slidedown")},150)}[].forEach.call(elements,function(e){e.addEventListener("click",clickToRemoveHandler,!1)});var sourceList=document.getElementById("TrataList"),targetList=document.getElementById("tratamientos");function isCountryInList(e){var t=!1,i=targetList.getElementsByClassName("country");return[].forEach.call(i,function(i){i.getAttribute("data-code")===e&&(t=!0,highlightItemInList(i))}),t}function highlightItemInList(e){e.classList.add("flashin"),setTimeout(function(){e.classList.remove("flashin")},450)}sourceList.addEventListener("change",function(){""===sourceList.value||isCountryInList(sourceList.value)||(null!=sourceList.length?$(":submit").removeAttr("disabled"):$(":submit").attr("disabled","disabled"),countryEl=document.createElement("div"),deleteEl=document.createElement("span"),inputEl=document.createElement("input"),countryEl.className="country hidden",countryEl.setAttribute("data-code",sourceList.value),countryEl.textContent=sourceList.options[sourceList.selectedIndex].textContent,deleteEl.className="delete",deleteEl.addEventListener("click",clickToRemoveHandler,!1),inputEl.setAttribute("type","hidden"),inputEl.setAttribute("name","consulta[]"),inputEl.setAttribute("value",sourceList.value),countryEl.appendChild(deleteEl),countryEl.appendChild(inputEl),titulo.push(sourceList.value),counter<3?(targetList.appendChild(countryEl),0==counter&&($("label[for=tdiag11]").html("Diagnóstico"),$("#diag2").attr("hidden","true"),$("#tdiag21").removeAttr("required"),$("#diag3").attr("hidden","true"),$("#tdiag3").removeAttr("required"),$(".delete").addClass("equis"+counter)),1==counter&&($("label[for=tdiag11]").html("Diagnóstico "+titulo[0]),$("label[for=tdiag21]").html("Diagnóstico "+titulo[1]),$("#diag2").removeAttr("hidden"),$("#tdiag21").attr("required",""),$("#diag3").attr("hidden","true"),$("#tdiag3").removeAttr("required"),$(".delete").addClass("equis"+counter),$(".equis0").addClass("escondido"),$(".equis0").removeClass("equis1")),2==counter&&($("label[for=tdiag31]").html("Diagnóstico "+titulo[2]),$("#conditional").attr("hidden","true"),$("#diag3").removeAttr("hidden"),$("#tdiag31").attr("required",""),$(".delete").addClass("equis"+counter),$(".avisog").addClass("parriba"),$(".equis1").addClass("escondido"),$(".equis0").removeClass("equis2"),$(".equis1").removeClass("equis2")),counter+=1):alert("Solo se permite registrar un máximo de tres operaciones"),itemAddHandler(countryEl)),sourceList.value=""});